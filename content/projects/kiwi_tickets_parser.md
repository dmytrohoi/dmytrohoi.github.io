Title: Kiwi Tickets Parser
Date: 2019-01-31 11:01
Modified: 2019-02-02 18:30
Tags: airparsebot, projects, lang:[üá∑üá∫](ru)
Slug: kiwi_tickets_parser
Summary: –°–∫—Ä–∏–ø—Ç —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –Ω–∞ –ø–æ–∫—É–ø–∫—É –±–∏–ª–µ—Ç–æ–≤ —Å —Å–∞–π—Ç–∞ Kiwi.com.


## –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—ã –≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ–∂–∏–º–µ –Ω–∞—Ö–æ–¥–∏–ª —Å–∞–º—ã–µ –¥–µ—à–µ–≤—ã–µ –±–∏–ª–µ—Ç—ã 
–∏ —Å–æ–∑–¥–∞–≤–∞–ª –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–∏—Ö –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤ Telegram –∫–∞–Ω–∞–ª–µ –Ω–∞ —Ç–µ–º—É 
—Ç—É—Ä–∏–∑–º–∞ (travel-channel).

-----

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π

–û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫: Python 3.6

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- requests - –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ø–æ REST API;

- json - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ JSON –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ–±—ä–µ–∫—Ç Python;

- tkinter - —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º—ã.

-----

## –ê–ª–≥–æ—Ä–∏—Ç–º

–°–∫—Ä–∏–ø—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–º–µ–Ω—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø—Ä–æ—Å–∞), –∏ –≤—ã–¥–∞–µ—Ç –ø–æ–ª—É—á–µ–Ω–Ω—É—é –∏–Ω—Ñ–æ–º–∞—Ü–∏—é –æ –±–∏–ª–µ—Ç–∞—Ö, –≤ –∑–∞–ª–æ–∂–µ–Ω–Ω–æ–º –≤ —Å–∫—Ä–∏–ø—Ç–µ –≤–∏–¥–µ, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤–∏–∞—Ä–µ–π—Å–∞ —Å —Å–∞–π—Ç–∞ Kiwi.com. –í–Ω—É—Ç—Ä–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è requests –∑–∞–ø—Ä–æ—Å –∫–æ—Ç–æ—Ä—ã–π –ø–æ API –ø–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ JSON –æ –∞–≤–∏–∞—Ä–µ–π—Å–∞—Ö –∏ –ø–µ—Ä–µ–≤–µ–¥—è —ç—Ç–æ—Ç json –≤ –æ–±—ä–µ–∫—Ç Python –∏–∑ —ç—Ç–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω—É–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.

![–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≥—Ä–∞–º–º—ã Kiwi Tickets Parser](/images/projects/kiwi_tickets_parser.jpg)

-----

## –ö–æ–¥

–ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ —á–∞—Å—Ç—å –∫–æ–¥–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã:

    headers = { 'apiKey': settings.API_KEY }
    URL = 'https://kiwicom-prod.apigee.net/v2/search'

    request = get(URL, params=payload, headers=headers)
    content = request.json()

    text.delete(1.0, END)
    text.insert(END, '\n\t–û–Ω–æ–≤–ª–µ–Ω–æ: ' + datetime.now().strftime('%H:%M'))

    if not content.get('data'): return text.insert(END, f'\n\n\t–í–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞! \n\n\t{(content.get("fault") if content.get("fault") else content.get("message"))}')

    affilid = settings.AFFILID

    CURR_SYMBOL = {
        'EUR': '‚Ç¨',
        'UAH': '‚Ç¥',
        'USD': '$'
    }

    curr = CURR_SYMBOL.get(payload['curr'], payload['curr'])

__–ò–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞—â–∏—â–µ–Ω–∞ –∞–≤—Ç–æ—Ä—Å–∫–∏–º–∏ –ø—Ä–∞–≤–∞–º–∏..__